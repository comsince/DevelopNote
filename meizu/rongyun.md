# 融云即时通讯功能分析
## 一.架构设计
融云提供的即时消息传输服务，不在 App 之外建立并行的用户体系，不需要同步用户账户，不影响 App 现有的系统架构与帐号体系，与现有业务体系能够实现完美融合。
融云的架构设计上具有如下特点：

  - 无需改变现有 App 的架构，直接嵌入现有代码框架中；
  - 无需改变现有 App Server 的架构，独立部署一份用于用户授权的 Service 即可；
  - 专注于提供通讯能力，使用私有的二进制通信协议，消息轻量、有序、不丢消息；
  - 安全的身份认证和授权方式，无需担心 SDK 能力滥用（盗用身份的垃圾消息、垃圾群发）问题。
具体如下图:

![enter image description here](http://www.rongcloud.cn/docs/assets/img/guide/archietecture.png)

蓝色为您的应用（App）和应用服务器（App Server），用户数据（User Data）和用户好友消息（Friend Relationship Data）保存在您的应用服务器上，融云不需要同步 App 的用户系统和好友关系；绿色为融云服务器（RongCloud Server）和融云 SDK，支持快速集成和平滑迁移。

蓝色箭头表示您自己的业务数据经由您自己的应用服务器；绿色剪头表示消息需要经过融云服务器转发（IM 的离线、通知等逻辑决定了消息必须经由服务器进行一次转发）；橙色箭头表示您的应用服务器只需要和融云服务器进行身份授权，不需要您提交详细用户资料。

## 二.客户端服务列表
### 1.单聊

指两个用户一对一进行聊天，会话关系由融云负责建立并保持，退出聊天界面或者离线后可以收到推送通知。
### 2.讨论组

指两个以上用户一起进行聊天，用户可以自行添加好友生成一个讨论组聊天，会话关系由融云负责建立并保持，退出聊天界面或者离线后可以收到推送通知。
群组聊天

指两个以上用户一起进行聊天，与讨论组不同的是，参与群组聊天的群成员 Id 集合由您的 App 提供并维系，融云只负责将消息传达给群聊中的所有用户，退出聊天界面或者离线后可以收到推送通知。支持最大至 3000 人的大型社群需求。
### 3.聊天室

不设用户上限的群体聊天行为，用户退出聊天界面即视为离开聊天室，不再会接收到任何通知和提醒。会话关系由融云负责建立并保持连接，通过 SDK 相关接口，可以让用户加入或者退出聊天室。
客服消息

用户与您的 App 后台客服进行消息通讯，支持单客服和多客服。
### 4.VoIP 音频通话

指通过 IP 网络，使两个用户建立一对一的音频通话。
### 5.会话列表

指各种会话依照顺序先后排列的界面，其中会话列表中的每一个列表项称之为一条会话。排列的先后顺序会依赖于置顶、最新会话、未读会话和时间等因素。

### 6.聊天界面

指聊天的具体界面，显示聊天的标题、成员头像、聊天内容、输入框等。

参考资料：

- [客户端开发指南](http://www.rongcloud.cn/docs/android.html)

## 三.Server提供的服务

   - 用户服务：从 App 服务端管理用户状态，获取身份认证令牌等。
   - 群组服务：从 App 服务端管理群组成员信息。
   - 聊天室服务：从 App 服务端管理聊天室信息。
   - 消息发送服务：从 App 服务端发送各种类型消息。
   - 消息路由服务：提供融云服务端到 App 服务端的消息路由服务。
   - 消息历史记录服务：提供 App 用户聊天消息历史记录下载服务。
   - 其他高级 API 接口服务：如果您需要额外的服务端接口能力，请联系我们的销售团队，或提交需求工单给我们。

参考资料：

- [Server 开发指南](http://www.rongcloud.cn/docs/server.html)

